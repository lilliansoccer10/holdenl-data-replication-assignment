---
title: "Analysis Replication"
author: "Lillian Holden"
date: "Due Decemeber 14th"
output: 
  html_document:
    toc: true
    toc_float:
      toc_collapsed: true
    toc_depth: 3
    theme: lumen
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### Load the Required Packages
```{r message=FALSE, warning=FALSE}
library(readr)
library(ggplot2)
#library(plyr)
library(dplyr)
library(shiny)
library(tidyverse)
```
Article Title: Seed fates of four rainforest tree species in the fragmented forests of
Anamalais in the southern Western Ghats, India 
Article By: Abhishek Gopala, Divya Mudappa, TR Shankar Raman, Rohit Naniwadekar
<br>

Introduction 
Seed predation is key in controlling plant population and the structure within forests. Forest fragmentation and habitat loss is directly correlated with seed predation and altered tree recruitment. This article examines four different rainforest tree species and the influence of forest type: benchmark N=3, fragmented N=5, and seed size on the proportion of seeds: 1) predated by vertebrate seed predators, 2) predated by
invertebrate seed predators, and 3) removed by vertebrate seed predators. The seeds were tracked by putting seeds in four 1x1 meter plots under each canopy type. Camera traps were placed under a subset of trees N=29 and there was a total of N=712 trap nights. Nine species of seed predators was recorded and it is noted that they differed between tree species. This study brings forth the idea that seed predation can alter regeneration patterns and alter adult tree communities in fragmented forests. 




## Replicating a Figure 

### The Figure Being Replicated 

![](Figure.png)

### Loading in the Data Set 
```{r}
my_data <- read_csv("/Users/lilyholden/Documents/GitHub/holdenl-data-replication-assignment/Distance_moved.csv", show_col_types = FALSE)
head(my_data)
```

### Organizing The Data Set with Piping 
```{r}
#Add Columns that Expresses Mean, Standard Deviation, Standard Error, Upper Limit, and Lower Limit and Organizes it by Tree Species and Forest Type
new_data <- my_data %>%  
  group_by(Tree_sp, Forest_type) %>%  
  summarize(Distance_moved_means=mean(Distance_moved_m), sd_Distance_moved=sd(Distance_moved_m),  
            N_N=n(),  
            se=sd_Distance_moved/sqrt(N_N),  
            upper_limit=Distance_moved_means+se,  
            lower_limit=Distance_moved_means-se
  )  
head(new_data)
```
```{r}
#Set What Your Upper Limit and Lower Limit within the Data Set Are in Order to Plot Error Bars ??? Do I need to do this? I don't think I do... 
upper_limit <- new_data$upper_limit
lower_limit <- new_data$lower_limit
```

### Replicating the Figure 
```{r warning=FALSE}
g <- ggplot() + 
geom_col(data = new_data, mapping = aes(x = Tree_sp, y = Distance_moved_means, group=Forest_type, fill = Forest_type), colour = "black", position = "dodge") +
geom_errorbar(data = new_data, aes(x=Tree_sp, ymin = lower_limit, ymax = upper_limit, fill= Forest_type), width=.2, position=position_dodge(.9)) 
g
```

## Replicating A Descriptive Statistical Analysis

![](Descriptive_Analysis.png)
### Loading in the Data
```{r}
data <- read_csv("/Users/lilyholden/Documents/GitHub/holdenl-data-replication-assignment/Visits_seedpredators_CT.csv", show_col_types = FALSE)
head(data)
```

#### Organizing Data
```{r}
#Add Columns that Expresses Mean and Standard Deviation
dataII <- data %>%  
  group_by(Tree_sp, Forest_type) %>%  
  summarise(Number_of_trees=Tree_id,Total=CT_trap_nights, Min=min(CT_trap_nights), Max=max(CT_trap_nights), Visitor_species_type=Body_size, Total_visits=Num_visits)
head(dataII)
```

#### Piping 
```{r}
dataIII <- 
  dataII %>%
  group_by(Tree_sp, Forest_type) %>%
  summarize(Number_of_trees = n_distinct(Number_of_trees))
dataIII
```
#### Piping 
```{r}
dataIIII <- 
  dataII %>%
  group_by(Tree_sp) %>%
  summarize(Max = max(Total, na.rm=TRUE))
dataIIII
```

#### Piping 
```{r}
dataV <- 
  dataII %>%
  group_by(Tree_sp) %>%
  summarize(Min = min(Total, na.rm=TRUE))
dataV
```

#### Piping 
```{r}
dataVI <- 
  dataII %>%
  group_by(Tree_sp, Visitor_species_type) %>%
  summarize(Total_visits=sum(Total_visits))
dataVI
```
#### Piping 
```{r}
dataVII <- 
  data %>%
  group_by(Tree_sp) %>%
  summarize(Total=sum(unique(CT_trap_nights)))
dataVII
```
Canarium and Persea match, but Heynea and Myristica do not, for some reason. 

### Merging Some of The Organized Data -- might not include or explain why it doesn't really work... 
```{r}
v <- merge(dataIII, dataIIII)
v
```

```{r}
w <- merge(v, dataV)
w
```

## GLMM Replication  

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(MuMIn)
library(lme4)
```

### Results of the GLMM Being Replicated

![](GLMM.png)
### Load in the Data
```{r}
glmdata <- read_csv("/Users/lilyholden/Documents/GitHub/holdenl-data-replication-assignment/2_Seed_fate.csv", show_col_types = FALSE)
head(glmdata)
```

```{r}
proportiondata <- read_csv("/Users/lilyholden/Documents/GitHub/holdenl-data-replication-assignment/Proportions.csv", show_col_types = FALSE)
head(proportiondata)
```
```{r}
newdata <- merge(glmdata, proportiondata, by="Tree_sp")
head(newdata)
```

### Replicating the GLMM for Each Model

```{r}
lme <- glmer(data=glmdata, Vertebrate_pred~Forest_type + Seed_size + (1 | Tree_sp), family = "poisson")
summary(lme, corr=FALSE)
```

```{r}
lme <- glmer(data=glmdata, Invertebrate_pred~Seed_size + Forest_type + Seed_size + (1 | Tree_sp), family = "poisson")
summary(lme, corr=FALSE)
```

```{r}
lme <- glmer(data=glmdata, Removed~Seed_size + Forest_type + Seed_size + (1 | Tree_sp), family = "poisson")
summary(lme, corr=FALSE)
```