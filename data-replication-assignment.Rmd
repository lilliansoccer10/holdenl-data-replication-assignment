---
title: "Analysis Replication"
author: "Lillian Holden"
date: "2023-10-14"
output: html_document
---

### Load the Required Packages
```{r warning=FALSE}
library(readr)
library(ggplot2)
#library(plyr)
library(dplyr)
library(shiny)
library(tidyverse)
```


### Replicating a Figure - The Figure Being Replicated 
```{r figure, echo=FALSE, fig.align='center', out.width='25%'}
knitr::include_graphics('~/Documents/GitHub/holdenl-data-replication-assignment/Figure.png')
```

## Loading in the Data Set 
```{r}
my_data <- read_csv("/Users/lilyholden/Documents/GitHub/holdenl-data-replication-assignment/Distance_moved.csv", show_col_types = TRUE)
my_data
```
```{r}
#Insert the Figure You are Trying to Replicate
```

## Organizing The Data Set with Piping 
```{r}
#Add Columns that Expresses Mean, Standard Deviation, Standard Error, Upper Limit, and Lower Limit and Organizes it by Tree Species and Forest Type
new_data <- my_data %>%  
  group_by(Tree_sp, Forest_type) %>%  
  summarize(Distance_moved_means=mean(Distance_moved_m), sd_Distance_moved=sd(Distance_moved_m),  
            N_N=n(),  
            se=sd_Distance_moved/sqrt(N_N),  
            upper_limit=Distance_moved_means+se,  
            lower_limit=Distance_moved_means-se
  )  
new_data
```
```{r}
#Set What Your Upper Limit and Lower Limit within the Data Set Are in Order to Plot Error Bars ??? Do I need to do this? I don't think I do... 
upper_limit <- new_data$upper_limit
lower_limit <- new_data$lower_limit
```

```{r warning=FALSE}
#Replicate the Figure 
g <- ggplot() + 
geom_col(data = new_data, mapping = aes(x = Tree_sp, y = Distance_moved_means, group=Forest_type, fill = Forest_type), colour = "black", position = "dodge") +
geom_errorbar(data = new_data, aes(x=Tree_sp, ymin = lower_limit, ymax = upper_limit, fill= Forest_type), width=.2, position=position_dodge(.9)) 
g
```

### Replicating A Descriptive Statistical Analysis

```{r figure, echo=FALSE, fig.align='center', out.width='25%'}
knitr::include_graphics('~/Documents/GitHub/holdenl-data-replication-assignment/Descriptive_Analysis.png')
```

```{r}
data <- read_csv("/Users/lilyholden/Documents/GitHub/holdenl-data-replication-assignment/Visits_seedpredators_CT.csv", show_col_types = FALSE)
data
```


```{r}
#Add Columns that Expresses Mean and Standard Deviation
dataII <- data %>%  
  group_by(Tree_sp, Forest_type) %>%  
  summarise(Number_of_trees=Tree_id,Total=CT_trap_nights, Min=min(CT_trap_nights), Max=max(CT_trap_nights), Visitor_species_type=Body_size, Total_visits=Num_visits, Mean_trap_nights=mean(CT_trap_nights)^-1, Sd_trap_nights=sd(CT_trap_nights)^-1)
dataII
```


```{r}
dataIII <- 
  dataII %>%
  group_by(Tree_sp, Forest_type) %>%
  summarize(count_distinct = n_distinct(Number_of_trees))
dataIII
```

```{r}
dataIIII <- 
  dataII %>%
  group_by(Tree_sp) %>%
  summarize(Max = max(Total, na.rm=TRUE))
dataIIII
```


```{r}
dataV <- 
  dataII %>%
  group_by(Tree_sp) %>%
  summarize(Min = min(Total, na.rm=TRUE))
dataV
```
```{r}
dataVI <- 
  dataII %>%
  group_by(Tree_sp, Visitor_species_type) %>%
  summarize(Total_visits=sum(Total_visits))
dataVI
```


##GLM 
```{r}
install.packages("vegan")
library(vegan)
```
```{r warning=FALSE}
library(tidyverse)
library(MuMIn)
library(lme4)
```

```{r figure, echo=FALSE, fig.align='center', out.width='25%'}
knitr::include_graphics('~/Documents/GitHub/holdenl-data-replication-assignment/GLMM.png')
```

```{r}
glmdata <- read_csv("/Users/lilyholden/Documents/GitHub/holdenl-data-replication-assignment/2_Seed_fate.csv", show_col_types = FALSE)
glmdata
```

```{r}
lme <- glmer(data=glmdata, Vertebrate_pred ~ Forest_type*Seed_size + Forest_type + Seed_size + (1 | Tree_sp), family = "poisson")
summary(lme, corr=FALSE)
```